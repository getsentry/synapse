proxy:
  listener:
    host: "10.0.0.1"
    port: 9000

  locator:
    type: in_process
    backup_route_store: null

  upstreams:
  - name: us1-getsentry
    url: "127.0.0.1:8080"
  - name: us2-getsentry
    url: "10.0.0.2:8080"
  - name: de-getsentry
    url: "10.0.0.3:8080"

  - name: us1-conduit
    url: "10.0.1.1:8080"
  - name: us2-conduit
    url: "10.0.1.2:8080"
  - name: de-conduit
    url: "10.0.1.3:8080"

  routes:
    - match:
        host: "*"
        path: /health/
        method: GET
      handler:
        name: health
    - match:
        host: "*"
        path: /ready/
        method: GET
      handler:
        name: ready
    - match:
        host: us.sentry.io
        path: /organizations/{organization_id_or_slug}/*
      proxy:
        resolver: resolve_cell_from_organization
        cell_to_upstream:
          us1: us1-getsentry
          us2: us2-getsentry
        default: us1-getsentry
    - match:
        host: us.sentry.io
        path: /cell/{cell_id}/*
      proxy:
        resolver: resolve_cell_from_id
        cell_to_upstream:
          us1: us1-getsentry
          us2: us2-getsentry
    - match:
        host: de.sentry.io
      proxy:
        to: de-getsentry
    - match:
        host: conduit.us.sentry.io
        path: /organizations/{organization_id_or_slug}/*
      proxy:
        resolver: resolve_cell_from_organization
        cell_to_upstream:
          us1: us1-conduit
          us2: us2-conduit
    - match:
        host: conduit.de.sentry.io
        path: /organizations/{organization_id_or_slug}/*
      proxy:
        to: de-conduit

logging:
  sentry_dsn: "your_sentry_dsn_here"

metrics:
  statsd_host: "127.0.0.1"
  statsd_port: 8126
